<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="Utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Testimonial collector</title>
</head>
<body style="background-color: rgb(240, 159, 159);">
    <h1 style="text-align:center">GIVE YOUR FEEDBACK</h1>
    <h3 style="text-align:center">"Your Experience, Our Improvement."</h3>
    <div class="card p-5 m-3 mx-auto text-center" style="height: 600px; width:800px; justify-content: center; background-color: rgb(188, 120, 120); ">
        <div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78, 1, 1);">*</span>Name:</label>
    </div>
    <div class="col-8">
        <input class="form-control" type="text" id="name" placeholder="Enter Your Name" style="background-color: rgb(239, 218, 218);">
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78, 1, 1);">*</span>Email:</label>
    </div>
    <div class="col-8">
        <input class="form-control" type="email" id="email" placeholder="Enter Your Email"  style="background-color: rgb(239, 218, 218);">
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78, 1, 1);">*</span>Phone Number:</label>
    </div>
    <div class="col-8">
        <input class="form-control" type="text" id="phone" placeholder="Enter Phone Number" style="background-color: rgb(239, 218, 218);">
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78,1,1);">*</span>Department:</label>
    </div>
    <div class="col-8">
        <select class="form-select" id="department" style="background-color: rgb(239, 218, 218);">
            <option selected disabled>Choose</option>
            <option value="cse">CSE</option>
            <option value="ece">ECE</option>
            <option value="it">IT</option>
            <option value="mech">MECH</option>
            <option value="aids">AIDS</option>
        </select>
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78, 1, 1);">*</span>Year:</label>
    </div>
    <div class="col-8">
        <select class="form-select" id="year" style="background-color: rgb(239, 218, 218);">
            <option disabled selected>Choose an option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78, 1, 1);">*</span>Rating:</label>
    </div>
    <div class="col-8">
        <select class="form-select" id="rating" style="background-color: rgb(239, 218, 218);">
            <option disabled selected>Choose an option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label><span style="color: rgb(78,1,1);">*</span>Message:</label>
    </div>
    <div class="col-8">
        <textarea class="form-control" type="text" id="message" placeholder="Enter Feedback" style="background-color: rgb(239, 218, 218);"></textarea>
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label>Upload image:</label>
    </div>
    <div class="col-8">
        <input class="form-control" type="file" id="imageUpload" accept="image/*" style="background-color: rgb(239, 218, 218);">
    </div>
</div>

<div class="row mb-3">
    <div class="col-4">
        <label>Video Link(Drive/Youtube):</label>
    </div>
    <div class="col-8">
        <input class="form-control" type="text" id="videoLink" placeholder="Paste video URL" style="background-color: rgb(239, 218, 218);">
    </div>
</div>
    <button onclick="submitFeedback()" style="background-color: rgb(239, 218, 218);">Submit</button> 
</div>
<div class="text-center">
<button id="viewBtn" onclick="window.location.href='03-display.html'" class="m-2 p-2"  style="background-color: rgb(239, 218, 218); text-align: center;display: none;">View All Feedback</button>
</div>
<script>
function submitFeedback() {
    let name=document.getElementById("name").value.trim();
    let email=document.getElementById("email").value.trim();
    let phone=document.getElementById("phone").value.trim();
    let department=document.getElementById("department").value;
    let year=document.getElementById("year").value;
    let rating=document.getElementById("rating").value;
    let message=document.getElementById("message").value.trim();
    let video=document.getElementById("videoLink").value.trim();
    let imageFile=document.getElementById("imageUpload").files[0];
    let emailPattern=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    let phonePattern=/^[0-9]{10}$/;

    if(name===""){
        alert("Please enter your name");
        return;
    }
    if(!emailPattern.test(email)){
        alert("Enter a valid email address");
        return;
    }
    if(!phonePattern.test(phone)) {
        alert("Phone number must be 10 digits");
        return;
    }
    if(department===""){
        alert("Please select a department");
        return;
    }
    if(year===""){
        alert("Please select a year");
        return;
    }
    if(rating===""){
        alert("Please give a rating");
        return;
    }
    if(message.length<5){
        alert("Feedback must be at least 5 characters long");
        return;
    }
    let reader=new FileReader();
    reader.onload=function(){
        
        let testimonial={
            name:name,
            email:email,
            phone:phone,
            department:department,
            year:year,
            rating:rating,
            message:message,
            video:video,
            image:reader.result || null
        };

        let data = JSON.parse(localStorage.getItem("testimonials"))||[];
        data.push(testimonial);

        localStorage.setItem("testimonials",JSON.stringify(data));

        alert("Feedback submitted successfully!");
        window.location.href="03-display.html";
    };

    if(imageFile) reader.readAsDataURL(imageFile);
    else reader.onload();
}
let role=localStorage.getItem("role");
if (role==="admin") {
    document.getElementById("viewBtn").style.display = "inline-block";
}
</script>
</body>
</html>